<!DOCTYPE html>
<!-- 如果你看到了这句话，说明……你用的根本就不是浏览器。 -->

<html>
	<head>
		<title>第3讲附录 FFmpeg - 小白也能学会的Galgame制作</title>
		<meta charset="utf-8" />
	</head>
	
	<body>
		<p><a href="javascript: window.close()">X关闭</a> | <a href="http://onstut.pe.hu/">首页</a></p>
		<h1>第3讲附录 FFmpeg</h1>
		<p>视频中提到了，dwave命令不支持.mp3格式的音频文件，需要用转码软件转成.wav或者.ogg格式。</p>
		<p>那么具体该怎么做呢？</p>
		<p>首先，我们需要一个转码软件，有很多种类。像付费的<a href="http://www.cyberlink.com/products/mediaespresso/" target="_blank">MediaEspresso</a>，但是我想大部分人都不愿意花钱吧？（<a href="http://www.gapp.gov.cn/cms/cms/upload/info/201203/740607/133317987342298209.doc" target="_blank">盗版可耻！</a>）</p>
		<p>至于免费的，你可能已经听说过<a href="http://www.pcfreetime.com/CN/index.html" target="_blank">格式工厂</a>了，它看起来是个十分优秀的软件，但实际上，我要告诉你一个非常不幸的消息——它的底层是FFmpeg，格式工厂只是做了个界面而已。</p>
		<p><a href="http://ffmpeg.org/" target="_blank">FFmpeg</a>是一个<a href="http://www.gnu.org/philosophy/free-sw.html" target="_blank">自由软件</a>，但是格式工厂使用了FFmpeg的东西却<a title="打不开？用后面这个链接凑合着看吧" href="https://zh.wikipedia.org/wiki/%E6%A0%BC%E5%BC%8F%E5%B7%A5%E5%8E%82#.E7.89.88.E6.AC.8A.E7.88.AD.E8.AD.B0" target="_blank">没有遵守其协议</a>（<a title="虽然这个链接可以凑合看，但是如果你有时间，还是最好参考一下页面底部的链接" href="http://baike.baidu.com/view/1820476.htm#6" target="_blank">参考资料备用链接</a>），这是非常可耻的。</p>
		<p>所以我们可以直接使用FFmpeg，这样不但可以有效地遏制代码盗用的现象，还能够获得更大的灵活性。但是有一个缺点，使用方法<b>看起来</b>似乎很难——这就是我写这个页面的原因。</p>
		<br />
		<p>首先先下载。但通常情况下<b>不是</b>官网上那个最大的“Download”按钮。</p>
		<p>Linux请使用各自的包管理器安装，Debian系的包名是libav-tools，其他的是ffmpeg。</p>
		<p>Windows请访问<a href="http://ffmpeg.zeranoe.com/builds/" target="_blank">这里</a>，按照<a href="https://support.microsoft.com/en-us/kb/827218/zh-cn" target="_blank">你的电脑是64位还是32位</a>，点击"Download FFmpeg git-******* 32-bit/64-bit <b>Static</b>"按钮。</p>
		<p>Mac OS X可以从<a href="http://evermeet.cx/ffmpeg/" target="_blank">这里</a>下载并把解压出来的文件拷到/usr/bin里，也可以使用<a href="http://brew.sh/" target="_blank">HomeBrew</a>或<a href="https://www.macports.org/" target="_blank">MacPorts</a>安装。</p>
		<br />
		<p>然后你需要运行FFmpeg，别惊讶，他是一个在<a href="https://zh.wikipedia.org/wiki/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%95%8C%E9%9D%A2" target="_blank">命令行界面</a>运行的程序，是没有<a href="https://zh.wikipedia.org/wiki/%E5%9B%BE%E5%BD%A2%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2" target="_blank">图形化界面</a>的。</p>
		<p>Linux和OS X直接打开终端输入ffmpeg（Debian系是avconv）。Windows在解压后运行ff-prompt.bat，出来一个<a href="image/ff-prompt.png" target="_blank">黑黑的窗口</a>，别害怕，这是正常的。</p>
		<p>
			然后cd到你要转换的文件所在的目录，比如我把文件放在了"C:\Users\Alex\Music"里面，就运行 <code>cd C:\Users\Alex\Music</code> 然后回车，注意如果路径包含空格，请用半角引号把<b>路径</b>包起来。<br />
			<img src="image/directory-01.png" alt="查看文件路径" /> <img src="image/directory-02.png" alt="复制" /> <img src="image/directory-03.png" alt="粘帖" /><br />
			<img src="image/directory-04.png" alt="按回车" /> <img src="image/directory-05.png" alt="完毕" /><br />
			<b>注意：</b>如果你使用的是Windows，且目标目录跟FFmpeg所处的地方不在一个盘符，需要<b>再</b>“运行”一下盘符。比如目标目录是D盘，则运行 <code>d:</code> （大小写无关）。
		</p>
		<p>
			然后运行 <code>ls</code> （OS X和Linux）或 <code>dir</code> （Windows）来查看当前目录的文件，如果输出的是你想要来到的目录（在我这儿是C:\Users\Alex\Music）中的文件，则cd成功了。<br />
			<img src="image/dir.png" alt="运行dir的结果" />
		</p>
		<p>然后开始转码，我这里以将 btn16.mp3 这个音频文件转换为 libvorbis 编码，并在同目录下保存为 btn16.ogg 作为例子。</p>
		<p>
			先输入 <code>ffmpeg</code> ，但别着急按回车，右边还要输入别的东西。<br />
			因为我们的输入文件叫做 btn16.mp3 ，所以在后面加上 <code>-i btn16.mp3</code> ，注意如果文件名包含空格，请用双引号把<b>文件名</b>包起来。<br />
			因为我们要把它的音频流（因为这是音频文件，只有个音频流，如果是视频就不一样了）转换为 libvorbis 编码，就加上 <code>-c:a libvorbis</code> <span style="text-decoration: line-through">，c代表codec，a代表audio</span>。<br />
			因为我们要把转换后的文件保存为 btn16.ogg ，所以在<b>最后</b>加上 <code>btn16.ogg</code> ，注意如果文件名包含空格，请用双引号把文件名包起来。
		</p>
		<p>
			总的来说，我们要运行的命令是 <code>ffmpeg -i btn16.mp3 -c:a libvorbis btn16.ogg</code> 。（别把我的句号也写进去啊！）<br />
			<img src="image/co.png" alt="在命令行中输入这一条命令" />
		</p>
		<p>
			然后按下回车，因为文件很小，所以一秒钟不到就完成了。<br />
			你的输出可能跟我不一样，但只要没出现红色的 <span style="color: red"><code>ERROR</code></span> 之类的字样，一般就是没有问题地完成了。<br />
			<img src="image/proc.png" alt="运行，完成" />
		</p>
		<p>如果你接下来不需要再转换别的文件，那么就可以直接关掉窗口，然后你会发现原来的地方多了个叫 btn16.ogg 的文件。大多数音乐播放器都可以播放它（Windows Media Player不算）。</p>
		<p>一切正常的话，把它复制到你的游戏目录（或游戏目录中的目录）里面，可以继续写脚本了！</p>
		<br /><br />
		<p style="text-decoration: overline">如果你发现在本页中的某些外部链接无法被打开，请参考<a href="../../cant-open.html" target="_blank">这个页面</a>。</p>
	</body>
</html>